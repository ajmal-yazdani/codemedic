namespace CodeMedic.Models;

/// <summary>
/// Represents a known vulnerability affecting a NuGet package version.
/// </summary>
public class PackageVulnerability
{
    /// <summary>
    /// Gets or sets the package name.
    /// </summary>
    public required string PackageName { get; set; }

    /// <summary>
    /// Gets or sets the vulnerable package version.
    /// </summary>
    public required string AffectedVersion { get; set; }

    /// <summary>
    /// Gets or sets the vulnerability identifier (CVE ID).
    /// </summary>
    public required string VulnerabilityId { get; set; }

    /// <summary>
    /// Gets or sets a brief description of the vulnerability.
    /// </summary>
    public required string Description { get; set; }

    /// <summary>
    /// Gets or sets the severity level (Critical, High, Moderate, Low, Unknown).
    /// </summary>
    public required string Severity { get; set; }

    /// <summary>
    /// Gets or sets the earliest version that fixes this vulnerability, if known.
    /// </summary>
    public string? FixedInVersion { get; set; }

    /// <summary>
    /// Gets or sets the date the vulnerability was published.
    /// </summary>
    public DateTime? PublishedDate { get; set; }

    /// <summary>
    /// Gets or sets a URL to more information about the vulnerability.
    /// </summary>
    public string? AdvisoryUrl { get; set; }

    /// <summary>
    /// Gets or sets the CVSS score (0.0-10.0) if available.
    /// </summary>
    public double? CvssScore { get; set; }
}
